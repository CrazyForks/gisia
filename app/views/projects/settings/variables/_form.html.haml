= form_with model: [@project.namespace.parent, @project, @project.variables.build], url: namespace_project_settings_variables_path(@project.namespace.parent.full_path, @project.namespace.path), method: :post, local: false do |form|
  %div{class: 'p-6'}
    %div{class: 'flex items-center justify-between mb-6'}
      %div
        %h3{class: 'text-lg font-semibold text-gray-900'}
          Add Variable
        %p{class: 'text-sm text-gray-600'}
          Create a new CI/CD variable

    %div{class: 'space-y-4'}
      %div
        = form.label :key, class: 'block text-sm font-medium text-gray-700 mb-2' do
          = icon 'key', class: 'inline w-4 h-4 mr-1'
          Key
        = form.text_field :key, class: 'w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent', placeholder: 'VARIABLE_NAME'

      %div
        = form.label :value, class: 'block text-sm font-medium text-gray-700 mb-2' do
          = icon 'code', class: 'inline w-4 h-4 mr-1'
          Value
        = form.text_area :value, rows: 3, class: 'w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent', placeholder: 'Variable value'

      %div
        = form.label :environment_scope, class: 'block text-sm font-medium text-gray-700 mb-2' do
          = icon 'globe', class: 'inline w-4 h-4 mr-1'
          Environment scope
        = form.text_field :environment_scope, value: '*', class: 'w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent', placeholder: '*'

      %div
        = form.label :description, class: 'block text-sm font-medium text-gray-700 mb-2' do
          = icon 'file-text', class: 'inline w-4 h-4 mr-1'
          Description
        = form.text_field :description, class: 'w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent', placeholder: 'Optional description'

      %div{class: 'space-y-3'}
        %div{class: 'flex items-center'}
          = form.check_box :protected, class: 'rounded border-gray-300 text-blue-600 focus:ring-blue-500'
          = form.label :protected, class: 'ml-2 text-sm text-gray-700' do
            = icon 'shield', class: 'inline w-4 h-4 mr-1'
            Protected
            %span{class: 'text-xs text-gray-500'}
              Export variable to pipelines running on protected branches and tags only

        %div{class: 'flex items-center'}
          = form.check_box :masked, class: 'rounded border-gray-300 text-blue-600 focus:ring-blue-500'
          = form.label :masked, class: 'ml-2 text-sm text-gray-700' do
            = icon 'eye-slash', class: 'inline w-4 h-4 mr-1'
            Masked
            %span{class: 'text-xs text-gray-500'}
              Variable will be masked in job logs

  %div{class: 'px-6 py-4 bg-gray-50 flex justify-end gap-3'}
    %button{type: 'button', class: 'btn btn-secondary', data: {action: 'collapsible#toggle'}}
      Cancel
    = form.submit 'Add variable', class: 'btn btn-primary'