- content_for :breadcrumb do
  - nodes = [{ label: @project.name, path: dashboard_project_path(@project) }, { label: 'Merge Requests', path: namespace_project_merge_requests_path(@project.namespace.parent.full_path, @project.path) }, { label: 'New', path: nil }]
  = render 'shared/breadcrumb', nodes: nodes

%div{ class: 'w-full bg-white p-6' }
  %div{ class: 'w-full max-w-6xl mx-auto flex flex-col px-4' }
    %div{ class: 'mb-8' }
      %h1{ class: 'text-2xl font-bold text-slate-900 mb-2' } New Merge Request
      %p{ class: 'text-slate-600' } Create a new merge request by selecting source and target projects and branches.

    = form_with model: @merge_request, url: namespace_project_merge_requests_path, local: true, data: { turbo: false } do |f|

      %div{ class: 'space-y-6' }
        %div{ class: 'hidden' }
          = f.select :source_project_id, options_from_collection_for_select(@projects, :id, :name), {}, class: 'w-full px-3 py-2 border border-slate-300 rounded-lg'
          = f.select :target_project_id, options_from_collection_for_select(@projects, :id, :name), {}, class: 'w-full px-3 py-2 border border-slate-300 rounded-lg'

        %div{ class: 'grid grid-cols-1 md:grid-cols-2 gap-6' }
          %div
            %label{ class: 'block text-sm font-medium text-slate-700 mb-2' } Source Branch
            = f.select :source_branch, options_for_select(@branches), {}, class: 'w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500'

          %div
            %label{ class: 'block text-sm font-medium text-slate-700 mb-2' } Target Branch
            = f.select :target_branch, options_for_select(@branches, @project.default_branch), {}, class: 'w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500'

        %div
          %label{ class: 'block text-sm font-medium text-slate-700 mb-2' } Title
          = f.text_field :title, class: 'w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500', placeholder: 'Enter merge request title'

        %div
          %label{ class: 'block text-sm font-medium text-slate-700 mb-2' } Description
          = f.text_area :description, rows: 6, class: 'w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500', placeholder: 'Describe the changes in this merge request'

        %div{ class: 'grid grid-cols-1 md:grid-cols-2 gap-6' }
          %div
            %label{ class: 'block text-sm font-medium text-slate-700 mb-2' } Assignees
            = f.select :assignee_ids, options_from_collection_for_select(@users, :id, :name), {}, multiple: true, class: 'w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500'

          %div
            %label{ class: 'block text-sm font-medium text-slate-700 mb-2' } Reviewers
            = f.select :reviewer_ids, options_from_collection_for_select(@users, :id, :name), {}, multiple: true, class: 'w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500'

      %div{ class: 'flex items-center gap-4 pt-6 border-t border-slate-200 mt-6' }
        = f.submit 'Create Merge Request', class: 'px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors duration-200'
        = link_to 'Cancel', namespace_project_merge_requests_path(@project.namespace.parent.full_path, @project.path), class: 'px-6 py-2 border border-slate-300 text-slate-700 hover:bg-slate-50 rounded-lg font-medium transition-colors duration-200'
