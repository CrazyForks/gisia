%div{ class: "diff-comment-form border-t border-b border-gray-300 bg-gray-50 p-4", id: "comment-form-#{line_code}", data: { line_code: line_code } }
  %div{ class: "mb-3" }
    %span{ class: "text-sm text-gray-600" }
      Commenting on line
      %span{ class: "font-mono font-medium" }= line_number

  = form_with(model: [project, merge_request, DiffNote.new], local: false, html: { data: { controller: "diff-comment-form" } }) do |form|
    %div{ class: "mb-4" }
      = form.text_area :note, placeholder: "Add a comment...",
        class: "w-full p-3 border border-gray-300 rounded-md resize-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
        rows: 4,
        data: { target: "diff-comment-form.textarea" }

    = form.hidden_field :line_code, value: line_code
    = form.hidden_field :position, value: position.to_json if defined?(position)

    %div{ class: "flex items-center justify-between" }
      %div{ class: "text-xs text-gray-500" }
        Markdown is supported
      %div{ class: "flex gap-2" }
        %button{ type: "button", class: "px-3 py-1 text-sm text-gray-600 hover:text-gray-800", data: { action: "click->diff-comment-form#cancel" } }
          Cancel
        = form.submit "Comment", class: "px-4 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700",
          data: { action: "click->diff-comment-form#submit" }