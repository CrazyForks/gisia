= turbo_frame_tag "files_frame", class: 'w-full' do
  %div{ class: 'bg-white border border-slate-200 rounded-lg overflow-hidden' }
    %div{ class: 'bg-slate-50 border-b border-slate-200 px-4 py-3' }
      %div{ class: 'flex items-center justify-between' }
        %div{ class: 'flex items-center gap-3' }
          %div{ class: 'flex items-center gap-2' }
            = icon 'git-branch', class: 'w-4 h-4 text-slate-500'
            %span{ class: 'text-sm font-medium text-slate-700' }
              Branch:
            - path_suffix = @path.present? && @path != '/' ? "/#{@path}" : ""
            = form_with url: "#", method: :get, data: { branch_base_url: @branch_base_url, path_suffix: path_suffix }, class: 'inline', local: true do
              = select_tag :ref, options_for_select(@branches, @current_ref), class: 'text-sm bg-white border border-slate-300 rounded px-2 py-1 text-slate-900 font-medium', onchange: "window.location.href = this.form.dataset.branchBaseUrl + '/' + this.value + this.form.dataset.pathSuffix"
          
          - if @path.present? && @path != '/'
            %div{ class: 'flex items-center gap-1 text-sm text-slate-500' }
              = icon 'caret-right', class: 'w-3 h-3'
              %span= @path
        
        %div{ class: 'flex items-center gap-2' }
          = link_to history_link(@project, @current_ref, @path, @ref_type), target: '_blank', class: 'inline-flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md hover:bg-slate-50 transition-colors' do
            = icon 'clock', class: 'w-4 h-4'
            History
    
    = render 'projects/file_list'
