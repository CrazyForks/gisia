- content_for :breadcrumb do
  - nodes = [{ label: 'Admin', path: admin_root_path }, { label: 'Groups', path: '#' }]
  = render 'shared/breadcrumb', nodes: nodes

%div{class: 'w-full bg-white p-2 rounded-lg'}
  %div{class: 'w-full max-w-6xl mx-auto'}

    %div{class: 'py-6'}
      %div{class: 'flex items-center justify-between mb-8'}
        %div
          %h1{class: 'text-2xl font-bold text-gray-900'} Groups
          %p{class: 'text-gray-600'} Manage group namespaces and memberships

    %div{class: 'grid grid-cols-1 md:grid-cols-3 gap-6 mb-8'}
      %div{class: 'bg-purple-50 border border-purple-200 rounded-xl p-6'}
        %div{class: 'text-center'}
          %div{class: 'flex items-center justify-center mb-2'}
            = icon 'buildings', class: 'w-8 h-8 text-purple-600'
          %h3{class: 'text-lg font-semibold text-gray-900'} Total Groups
          %p{class: 'text-3xl font-bold text-purple-600 mt-2'}= @groups_count

      %div{class: 'bg-green-50 border border-green-200 rounded-xl p-6'}
        %div{class: 'text-center'}
          %div{class: 'flex items-center justify-center mb-2'}
            = icon 'check-circle', class: 'w-8 h-8 text-green-600'
          %h3{class: 'text-lg font-semibold text-gray-900'} Active Groups
          %p{class: 'text-3xl font-bold text-green-600 mt-2'}= @groups_count

      %div{class: 'bg-blue-50 border border-blue-200 rounded-xl p-6'}
        %div{class: 'text-center'}
          %div{class: 'flex items-center justify-center mb-2'}
            = icon 'users', class: 'w-8 h-8 text-blue-600'
          %h3{class: 'text-lg font-semibold text-gray-900'} Group Members
          %p{class: 'text-3xl font-bold text-blue-600 mt-2'}= @groups.sum { |group| group.members.count }

    %div{class: 'mb-6'}
      = form_with url: admin_groups_path, method: :get, local: false, class: 'flex items-center gap-4 mb-6', data: { controller: 'search', turbo_frame: 'groups_content' } do |form|
        %div{class: 'flex-1'}
          = form.text_field :search, placeholder: 'Search groups', value: params[:search], class: 'w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent', data: { action: 'input->search#search' }
        %div{class: 'relative', data: { controller: 'searchable-select', 'searchable-select-url-value': '', 'searchable-select-selected-value': params[:visibility], 'searchable-select-options-value': JSON.generate([['All visibility levels', ''], ['Public', 'public'], ['Internal', 'internal'], ['Private', 'private']]) }}
          = form.hidden_field :visibility, { data: { 'searchable-select-target': 'hiddenInput' } }
          - current_visibility_text = case params[:visibility]
          - when 'public' then 'Public'
          - when 'internal' then 'Internal'
          - when 'private' then 'Private'
          - else 'All visibility levels'
          %input{type: 'text', readonly: true, value: current_visibility_text, class: 'px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent cursor-pointer w-40', data: { 'searchable-select-target': 'input', action: 'click->searchable-select#toggle' }}
          %div{class: 'absolute top-full left-0 right-0 bg-white border border-gray-300 rounded-lg z-10 hidden', data: { 'searchable-select-target': 'dropdown' }}
            %div{data: { 'searchable-select-target': 'options' }}
              Loading...

    = turbo_frame_tag 'groups_content' do
      = render 'group_list'
