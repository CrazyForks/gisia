- content_for :breadcrumb do
  - nodes = [{ label: 'Admin', path: admin_root_path }, { label: 'Runners', path: admin_runners_path }, { label: "Runner ##{@runner.id}", path: '#' }]
  = render 'shared/breadcrumb', nodes: nodes

%div{class: 'w-full bg-white p-2 rounded-lg'}
  %div{class: 'w-full max-w-6xl mx-auto'}

    %div{class: 'py-6'}
      %div{class: 'flex items-center justify-between mb-6'}
        %div{class: 'flex items-center gap-4'}
          %div{class: 'flex-shrink-0'}
            = icon 'gear', class: 'w-12 h-12 text-gray-400'
          %div
            %h1{class: 'text-2xl font-bold text-gray-900'} Runner ##{@runner.id}
            %div{class: 'flex items-center gap-2 mt-1'}
              %span{class: 'inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800'}
                = @runner.runner_type.humanize
              - if @runner.online?
                %span{class: 'inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800'} Online
              - elsif @runner.stale?
                %span{class: 'inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800'} Stale
              - elsif @runner.contacted_at.nil?
                %span{class: 'inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800'} Never contacted
              - else
                %span{class: 'inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800'} Offline

        %div{class: 'flex items-center gap-3'}
          - if @runner.active?
            = link_to pause_admin_runner_path(@runner), method: :post, class: 'inline-flex items-center gap-2 px-4 py-2 bg-yellow-600 text-white text-sm font-medium rounded-lg hover:bg-yellow-700 transition-all duration-200' do
              = icon 'pause', class: 'w-4 h-4'
              Pause
          - else
            = link_to resume_admin_runner_path(@runner), method: :post, class: 'inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 transition-all duration-200' do
              = icon 'play', class: 'w-4 h-4'
              Resume
          = link_to edit_admin_runner_path(@runner), class: 'inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-all duration-200' do
            = icon 'pencil', class: 'w-4 h-4'
            Edit

    %div{class: 'grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6'}
      %div{class: 'bg-gray-50 border border-gray-200 rounded-lg p-6'}
        %h3{class: 'text-lg font-semibold text-gray-900 mb-4'} Runner Information

        %dl{class: 'space-y-3'}
          %div
            %dt{class: 'text-sm font-medium text-gray-500'} Description
            %dd{class: 'text-sm text-gray-900'}= @runner.description.presence || 'No description'

          %div
            %dt{class: 'text-sm font-medium text-gray-500'} Runner Type
            %dd{class: 'text-sm text-gray-900'}= @runner.runner_type.humanize

          %div
            %dt{class: 'text-sm font-medium text-gray-500'} Status
            %dd{class: 'text-sm text-gray-900'}
              - if @runner.online?
                Online
              - elsif @runner.stale?
                Stale
              - elsif @runner.contacted_at.nil?
                Never contacted
              - else
                Offline

      %div{class: 'bg-gray-50 border border-gray-200 rounded-lg p-6'}
        %h3{class: 'text-lg font-semibold text-gray-900 mb-4'} Activity

        %dl{class: 'space-y-3'}
          %div
            %dt{class: 'text-sm font-medium text-gray-500'} Last contact
            %dd{class: 'text-sm text-gray-900'}= @runner.contacted_at&.strftime('%B %d, %Y at %H:%M') || 'Never'

          %div
            %dt{class: 'text-sm font-medium text-gray-500'} Created
            %dd{class: 'text-sm text-gray-900'}= @runner.created_at.strftime('%B %d, %Y at %H:%M')

          %div
            %dt{class: 'text-sm font-medium text-gray-500'} Jobs run
            %dd{class: 'text-sm text-gray-900'}= @runner.builds.count

          %div
            %dt{class: 'text-sm font-medium text-gray-500'} Maximum timeout
            %dd{class: 'text-sm text-gray-900'}= @runner.maximum_timeout ? "#{@runner.maximum_timeout} seconds" : 'Not set'

    %div{class: 'bg-gray-50 border border-gray-200 rounded-lg p-6 mb-6'}
      %h3{class: 'text-lg font-semibold text-gray-900 mb-4'} Configuration

      %div{class: 'grid grid-cols-1 md:grid-cols-2 gap-6'}
        %div
          %h4{class: 'text-sm font-medium text-gray-900 mb-3'} Settings
          %div{class: 'space-y-2'}
            %div{class: 'flex items-center'}
              - if @runner.run_untagged?
                = icon 'check', class: 'w-4 h-4 text-green-600'
              - else
                = icon 'x', class: 'w-4 h-4 text-red-600'
              %span{class: 'ml-2 text-sm text-gray-700'} Run untagged jobs

        %div
          %h4{class: 'text-sm font-medium text-gray-900 mb-3'} Tags
          - if @runner.tags.any?
            %div{class: 'flex flex-wrap gap-2'}
              - @runner.tags.each do |tag|
                %span{class: 'inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800'}= tag.name
          - else
            %span{class: 'text-sm text-gray-500'} No tags

    - if @runner.builds.any?
      %div{class: 'bg-gray-50 border border-gray-200 rounded-lg p-6'}
        %h3{class: 'text-lg font-semibold text-gray-900 mb-4'} Recent Jobs
        
        %div{class: 'overflow-hidden'}
          %table{class: 'min-w-full'}
            %thead{class: 'bg-gray-100'}
              %tr
                %th{class: 'px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase'} Job
                %th{class: 'px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase'} Status
                %th{class: 'px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase'} Started
                %th{class: 'px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase'} Duration

            %tbody{class: 'divide-y divide-gray-200'}
              - @runner.builds.limit(5).each do |build|
                %tr
                  %td{class: 'px-4 py-2 text-sm text-gray-900'} ##{build.id}
                  %td{class: 'px-4 py-2'}
                    %span{class: 'inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800'}= build.status.humanize
                  %td{class: 'px-4 py-2 text-sm text-gray-500'}= build.created_at.strftime('%b %d, %H:%M')
                  %td{class: 'px-4 py-2 text-sm text-gray-500'}= build.duration ? "#{build.duration}s" : '-'

        - if @runner.builds.count > 5
          %div{class: 'mt-4 text-center'}
            = link_to admin_jobs_path(runner_id: @runner.id), class: 'text-blue-600 hover:text-blue-800 text-sm' do
              View all #{@runner.builds.count} jobs