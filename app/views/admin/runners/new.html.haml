- content_for :breadcrumb do
  - nodes = [{ label: 'Admin', path: admin_root_path }, { label: 'Runners', path: admin_runners_path }, { label: 'New', path: '#' }]
  = render 'shared/breadcrumb', nodes: nodes

%div{ class: "w-full bg-white p-2 rounded-lg" }
  %div{ class: "w-full max-w-6xl mx-auto" }

    %div{class: 'py-6'}
      %h1{ class: "text-2xl font-bold text-gray-900 mb-2" } New Instance Runner

    %p{ class: "text-gray-600 mb-6" }
      Create an instance runner to generate a command that registers the runner with all its configurations.

    = form_with model: @runner, url: admin_runners_path, local: true do |f|
      %div{class: 'bg-gray-50 border border-gray-200 rounded-lg p-6 mb-6'}
        %h3{class: 'text-lg font-semibold text-gray-900 mb-6'} Basic Configuration

        %div{class: 'mb-6'}
          = f.label :tags, 'Tags', class: 'block text-sm font-medium text-gray-700 mb-2'
          %p{class: 'text-sm text-gray-500 mb-2'}
            Add tags to specify jobs that the runner can run.
            = link_to 'Learn more', '/help/ci/runners/configure_runners#control-jobs-that-a-runner-can-run', target: '_blank', rel: 'noopener noreferrer', class: 'text-blue-600 underline'
          = f.text_field :tags, value: @runner.tags.pluck(:name).join(", "), class: 'w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
          %p{class: 'text-xs text-gray-500 mt-1'}
            Separate multiple tags with a comma. For example,
            %code macos, shared

        %div{class: 'flex items-center mb-4'}
          = f.check_box :run_untagged, class: 'h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded'
          = f.label :run_untagged, 'Run untagged jobs', class: 'ml-2 block text-sm text-gray-900'
          %p{class: 'ml-6 text-xs text-gray-500'} Use the runner for jobs without tags in addition to tagged jobs.

        %div{class: 'mb-4'}
          = f.label :description, 'Runner description', class: 'block text-sm font-medium text-gray-700 mb-2'
          = f.text_field :description, class: 'w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'

      %div{class: 'bg-gray-50 border border-gray-200 rounded-lg p-6 mb-6'}
        %h3{class: 'text-lg font-semibold text-gray-900 mb-6'} Advanced Configuration (optional)

        %div{class: 'mb-4'}
          = f.label :maintenance_note, 'Maintenance note', class: 'block text-sm font-medium text-gray-700 mb-2'
          %p{class: 'text-sm text-gray-500 mb-2'} Only administrators can view this.
          = f.text_area :maintenance_note, rows: 4, class: 'w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
          %p{class: 'text-xs text-gray-500 mt-1'} Add notes such as the runner owner or what it should be used for.

        %div{class: 'flex items-center mb-4'}
          = f.check_box :paused, class: 'h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded'
          = f.label :paused, 'Paused', class: 'ml-2 block text-sm text-gray-900'
          %p{class: 'ml-6 text-xs text-gray-500'} Stop the runner from accepting new jobs.

        %div{class: 'flex items-center mb-4'}
          = f.check_box :protected, class: 'h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded'
          = f.label :protected, 'Protected', class: 'ml-2 block text-sm text-gray-900'
          %p{class: 'ml-6 text-xs text-gray-500'} Use the runner on pipelines for protected branches only.

        %div{class: 'mb-4'}
          = f.label :maximum_timeout, 'Maximum job timeout', class: 'block text-sm font-medium text-gray-700 mb-2'
          %p{class: 'text-sm text-gray-500 mb-2'}
            Maximum amount of time the runner can run before it terminates.
            If a project has a shorter job timeout period, the job timeout period of the instance runner is used instead.
          = f.number_field :maximum_timeout, class: 'w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent'
          %p{class: 'text-xs text-gray-500 mt-1'} Enter the job timeout in seconds. Must be a minimum of 600 seconds.

      %div{class: 'flex items-center gap-3'}
        = f.submit 'Create Runner', class: 'inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-all duration-200'
        = link_to 'Cancel', admin_runners_path, class: 'inline-flex items-center gap-2 px-4 py-2 bg-gray-200 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-300 transition-all duration-200'

